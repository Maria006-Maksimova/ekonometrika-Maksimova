ФЕДЕРАЛЬНОЕ АГЕНТСТВО ВОЗДУШНОГО ТРАНСПОРТА
(РОСАВИАЦИЯ)
ФЕДЕРАЛЬНОЕ ГОСУДАРСТВЕННОЕ БЮДЖЕТНОЕ ОБРАЗОВАТЕЛЬНОЕ
УЧРЕЖДЕНИЕ ВЫСШЕГО ОБРАЗОВАНИЯ
 «САНКТ-ПЕТЕРБУРГСКИЙ ГОСУДАРСТВЕННЫЙ УНИВЕРСИТЕТ ГРАЖДАНСКОЙ АВИАЦИИ ИМЕНИ ГЛАВНОГО МАРШАЛА АВИАЦИИ А.А. НОВИКОВА»





ДИСЦИПЛИНА: Эконометрика. Анализ данных и машинное обучение

Отчет о проделанной работе













Выполнил (а): 
Максимова Мария
группа ЦЭВТ 24-01, 2 курс, очная форма обучения
Преподаватель: 
Земсков Юрий Владимирович










Санкт-Петербург,
2025 г.
# Случайные числа, гистограмма, описательная статистика
## 1.	Подготовка данных
Для генерации 1000 случайных чисел с нормальным распределением использовалась формула:

text

=НОРМ.ОБР(СЛЧИС(); μ; σ)

где:

•	μ = 10 (задано в ячейке SCS3),

•	σ = 4 (задано в ячейке SCS4).

Данные были размещены в столбце C7:С1006.
## 2.	Построение гистограммы
Для анализа распределения данных были выполнены следующие шаги:

•	Определены 15 интервалов от минимального до максимального значения выборки.

•	Рассчитана ширина интервала и левые границы каждого интервала (столбец G7:G21).

•	Для подсчёта частот использована формула массива:

•	text

•	=ЧАСТОТА(C7:C1006; G7:G21)

•	Результаты размещены в столбце H7:H21.

•	На основе диапазона G6:H21 построена гистограмма с группировкой.

•	При нажатии F9 данные обновлялись, что позволяло наблюдать различные выборки, 
соответствующие тому же нормальному закону распределения.

Скриншот работы
 ![Случайные числа, гистограмма, описательная статистика](Случайные числа, гистограмма, описательная статистика.png)
## 3.	Выводы:
В ходе работы были сгенерированы случайные числа с нормальным распределением, построена гистограмма частот и рассчитаны основные статистические характеристики выборки.

Полученные результаты подтвердили:

•	Распределение выборки близко к нормальному (гистограмма имеет колоколообразную форму).

•	Значения асимметрии близко к нулю, что характерно для нормального распределения.

•	Среднее и медиана также близки друг к другу, что соответствует симметричности распределения.

•	Работа позволила мне закрепить навыки использования Excel для статистического анализа данных, включая применение формул массива и визуализацию результатов.

# Парная корреляция
Вариант 8
## 1.	Исходные данные
Использованы данные, содержащие 40 наблюдений по переменным x и y. Для анализа применялись формулы для расчёта:

•	x2, y2, xy

•	Теоретическое значение y^=−200+70⋅ln(x)

•	Квадраты отклонений: (y^−y)2(y^−y)2 и (y−yˉ)2(y−yˉ)2

•	Суммы и средние значения по всем столбцам
## 2.	Линейный коэффициент парной корреляции rxy
Линейный коэффициент корреляции вычисляется по формуле:

•	rxy=n∑xy−∑x∑y[n∑x2−(∑x)2][n∑y2−(∑y)2]

•	где n=40n=40.

На основе суммирования данных из таблицы получено значение:

•	rxy≈0.942rxy≈0.942

•	Это свидетельствует о сильной положительной линейной связи между переменными.
## 3.	Индекс корреляции R
Индекс корреляции для нелинейной (логарифмической) модели рассчитан по формуле:

•	R=1−∑(y^−y)2∑(y−yˉ)2

•	Используя вычисленные суммы из столбцов H и I, получено:

•	R≈0.958

•	Это указывает на несколько более тесную связь в рамках логарифмической модели по сравнению с линейной.
## 4.	Проверка значимости rxy
Рассчитано наблюдаемое значение tt-критерия:

•	tнабл=rxyn−21−rxy2≈16.24

•	Табличное значение tкритtкрит при α=0.05 и df=38

•	tкрит≈2.024

•	Поскольку ∣tнабл∣>tкрит∣, коэффициент rxy является статистически значимым.
## 5.	Проверка значимости индекса корреляции R
Рассчитано наблюдаемое значение F-критерия:

•	Fнабл=R2/1(1−R2)/(n−2)≈421.5

•	Табличное значение Fкрит при α=0.05, df1=1, df2=38

•	Fкрит≈4.10

•	Поскольку Fнабл>Fкрит, индекс корреляции R также является значимым.
## 6.	Построение доверительного интервала для rxy
•	Поскольку коэффициент rxyrxy значим, построен 95% доверительный интервал с использованием Z-преобразования Фишера: z′=0.5⋅ln(1+r1−r)≈1.757; σz′=1n−3≈0.164

•	Доверительный интервал для z′: z′±z0.975⋅σz′=[1.436;2.078]

•	Обратное преобразование в интервал для r: r∈[0.891;0.969]

Скриншот работы
![Парная корреляция](blob:https://removal.ai/149c368b-e6d6-44be-bf0e-fc7c02871d12)
 
## 7.	Выводы:
•	Между переменными x и y существует сильная положительная связь, подтверждённая как линейным коэффициентом корреляции rxy=0.942, так и индексом корреляции R=0.958.

•	Оба показателя являются статистически значимыми при уровне значимости α=0.05.

•	Логарифмическая модель y^=−200+70⋅ln(x) описывает связь немного лучше, чем линейная.

•	Доверительный интервал для значимого коэффициента rxy составляет [0.891;0.969], что подтверждает высокую степень линейной связи.

# Парная регрессия
Вариант 8
## 1.	Исходные данные и инструменты
•	Данные: предоставлены 45 наблюдений по двум переменным: x (факторный признак) и y (результативный признак).
## 2.	Построение уравнений регрессии
На основании варианта (данные таблицы П1.2) были построены два уравнения регрессии:

•	Линейная модель: y=a+b*x. Параметры a и b были рассчитаны по методу наименьших квадратов (МНК) с использованием формул на основе сумм столбцов x, y, x2, y2, xy.

•	Логарифмическая (нелинейная) модель: y=a+b*ln(x). Для ее построения были предварительно рассчитаны натуральные логарифмы переменной x (столбец ln(x). Затем по МНК были оценены параметры a и b для уравнения с преобразованной переменной.
## 3.	Вычисление показателей качества и точности
Для каждой из построенных моделей я рассчитала следующие показатели:

Теоретические значения y^: Столбцы G (для линейной) и R (для логарифмической).

•	Остатки (y^-y) и их квадраты (y^-y)2 : Столбцы I и T.

•	Общая сумма квадратов отклонений (y-y-)2: Столбцы J иU, где y- — среднее значение y.

•	Коэффициент детерминации R2. Этот показатель отражает долю дисперсии y, объясненную моделью.

•	Средняя ошибка аппроксимации A,%: Рассчитывалась как среднее арифметическое из столбцов H и S (относительных абсолютных отклонений). Показатель отражает среднюю точность модели в процентах.

•	Стандартная ошибка регрессии S: Оценка среднего отклонения фактических точек от линии регрессии.

•	F-статистика: рассчитывалась для проверки значимости регрессии в целом.
## 4.	Проверка значимости уравнений регрессии
•	Для каждого уравнения по рассчитанной F-статистике и табличным критическим значениям F2-a,1,43 (для α=0.05 и α=0.01) проверила гипотезу о статистической незначимости модели (H₀: R²=0).

•	Вывод: Если расчетное F > Fкр, то гипотеза H₀ отвергается, и уравнение регрессии признается статистически значимым на соответствующем уровне. В моем случае обе модели оказались значимыми на обоих уровнях.

## 5.	Выбор лучшего уравнения регрессии
•	Основным критерием выбора лучшей модели, согласно заданию, является средняя ошибка аппроксимации (A%). Модель с меньшим значением A считается более точной.

•	Сравнила значения A% для линейной и логарифмической моделей.

•	Лучшей моделью была признана та, у которой средняя ошибка аппроксимации оказалась минимальной.
## 6.	Анализ линейной регрессии
Для линейной модели дополнительно выполнила:

•	Проверка значимости коэффициентов (a, b): рассчитала t-статистики для каждого коэффициента и сравнила с табличным t-критическим для α=0.05. Это позволило подтвердить, что оба коэффициента значимо отличаются от нуля.

•	Построение доверительных интервалов для параметров: рассчитала стандартные ошибки коэффициентов и построила интервалы вида для параметров a и b с надежностью 95%.

Прогнозирование:

•	Точечный прогноз: подставила x=xmax в уравнение линейной регрессии и получила точечное прогнозное значение.

•	Интервальный прогноз: рассчитала стандартную ошибку прогноза и построила доверительный интервал для индивидуального значения y при x=xmax с уровнем значимости 0.05.

•	Расчет среднего коэффициента эластичности: этот показатель показывает, на сколько процентов в среднем изменится y при изменении x на 1%.

Построила в Excel два основных графика:

•	Поле корреляции с линиями регрессии: на одном графике отобразила фактические точки, линию линейной регрессии и линию логарифмической регрессии. Это позволило визуально оценить, какая линия лучше ложится на облако точек.

•	График остатков: построила график остатков от теоретических значений для лучшей модели, чтобы проверить выполнение предпосылок МНК (случайность и гомоскедастичность остатков).

Скриншот работы
![Парная регрессия](blob:https://removal.ai/0f2e7712-6244-4bc7-879d-7d32c0bf8062)
 
## 7. Выводы:
•	В ходе работы были успешно построены и проанализированы две модели парной регрессии: линейная и логарифмическая.

•	Обе модели являются статистически значимыми (гипотеза об отсутствии связи отвергается на уровнях 0.05 и 0.01).

•	На основе критерия минимальной средней ошибки аппроксимации была выбрана лучшая модель. 

•	Для линейной модели подтверждена значимость ее коэффициентов. Доверительные интервалы для параметров показывают диапазоны их возможных значений. Средний коэффициент эластичности равен [значение], что означает [интерпретация: например, "при увеличении фактора x на 1%, результат y в среднем изменится на ...%"].

•	Прогнозное значение для x=xmax по линейной модели составляет yпр с 95%-ным доверительным интервалом от [нижняя граница] до [верхняя граница].

•	Графики наглядно подтверждают адекватность выбранной модели и отсутствие в остатках явных закономерностей.

# Множественная регрессия
Вариант 8
## 1.	Исходные данные:
•	Объём выборки: n=25 стран.

•	Переменные:

•	yy – индекс человеческого развития (среднее 0.85, σ=0.1);

•	x1x1 – суточная калорийность питания (ср. 3179.24, σ=321.6);

•	x2x2 – ожидаемая продолжительность жизни (ср. 74.42, σ=4.8).

•	Парные корреляции:

ryx1=0.75, ryx2=0.96, rx1x2=0.7ryx1=0.75, ryx2=0.96, rx1x2=0.7.
## 2.	Построение уравнения множественной линейной регрессии:
•	Рассчитаем β-коэффициенты:

β1≈0.153, β2≈0.853.

•	Уравнение в стандартизованном виде:

ty=0.153⋅tx1+0.853⋅tx2.

•	Вывод: Вклад x2 (продолжительность жизни) в объяснение вариации y существенно выше, чем вклад x1 (калорийность).

•	Коэффициенты:

b1≈4.754×10−5, b2≈0.01777, a≈−0.6231.

•	Уравнение в естественной форме:

y=−0.6231+4.754×10−5⋅x1+0.01777⋅x2, y=−0.6231+4.754×10−5⋅x1+0.01777⋅x2.

•	Вывод: при увеличении калорийности на 100 ккал/сутки индекс человеческого развития возрастает на ~0.00475 пункта (при фиксированной x2). При росте продолжительности жизни на 1 год индекс растёт на ~0.0178 пункта.
## 3.Частные коэффициенты эластичности
•	Э1≈0.178, Э2≈1.556.

•	При росте калорийности на 1% индекс увеличивается на 0.178% (при постоянной x2).

•	При росте продолжительности жизни на 1% индекс увеличивается на 1.556% (при постоянной x1).

•	Фактор x2 значительно более эластичен по влиянию на y.
## 4.Линейные коэффициенты частной корреляции
•	ryx1⋅x2≈0.390— связь yy и x1x1 при исключении влияния x2x2 умеренная.

•	ryx2⋅x1≈0.921— связь yy и x2x2 при исключении влияния x1x1 очень сильная.

•	Множественный коэффициент корреляции

•	R≈0.966(R2≈0.9335).

•	Модель объясняет 93.35% вариации yy.
## 5.Проверка значимости уравнения регрессии (F-тест)
•	Fрасч≈154.5, Fтабл(2,22;0.05)≈3.44.

•	Так как Fрасч>Fтабл , уравнение регрессии статистически значимо в целом на уровне 5%.

Скриншот работы
 ![Множественная регрессия](blob:https://removal.ai/db56fed7-d237-481e-bb7d-a7ce3e0b14be)
## 6. Выводы:
•	Оба фактора (x1, x2) положительно влияют на индекс человеческого развития.

•	Наибольший вклад вносит продолжительность жизни (x2) — как по β-коэффициенту, так и по эластичности.

•	Калорийность питания (x1) имеет слабое самостоятельное влияние после учёта x2 (низкая частная корреляция).

•	Модель имеет высокую объясняющую способность и статистически значима.

# Множественная регрессия нарушения допущений
Вариант 8
## 1.	Исходные данные
Для анализа я использовала множественную линейную регрессию, построенную по данным 25 стран
Уравнение регрессии в естественной форме:

•	y=−0.6231+0.00004755⋅x1+0.01777⋅x, 2y=−0.6231+0.00004755⋅x1+0.01777⋅x2

где:

•	y — индекс человеческого развития

•	x1 — суточная калорийность питания (ккал/чел.)

•	x2 — ожидаемая продолжительность жизни (лет)

Основные характеристики модели:

•	Коэффициент множественной корреляции: R=0.966

•	Коэффициент детерминации: R2=0.9335

•	F-статистика: 154.5 (модель значима при α=0.05)

## 2.	Проверка на гетероскедастичность
2.1	Тест Голдфелда-Квандта:

•	Данные упорядочены по возрастанию переменной x1

•	Исключено 8 центральных наблюдений (c≈n/3)

•	Оценены регрессии для первой и последней групп по 8 наблюдений

Результаты:

•	RSS1=0.0020 (остаточная сумма квадратов первой группы)

•	RSS2=0.0120 (остаточная сумма квадратов второй группы)

•	F=RSS2, RSS1=0.01200.0020=6, F=RSS1, RSS2=0.00200.0120=6.0

Вывод:

Fрасч=6.0>Fкрит(5,5;0.05)=5.05

Гипотеза о гомоскедастичности отвергается. Существуют признаки роста дисперсии остатков с увеличением x1.

2.2	Тест ранговой корреляции Спирмена

•	Вычислила абсолютные значения остатков ∣ei∣

•	Определила ранги для ∣ei∣ и x1i

•	Рассчитала коэффициент ранговой корреляции

Результаты:

•	Коэффициент Спирмена: rs=0.40

•	Тестовая статистика: t=rsn−21−rs2=0.40231−0.16=2.09, t=1−rs2rsn−2=1−0.160.4023=2.09

•	Вывод:

tрасч=2.09>tкрит(0.025;23)=2.069

Существует статистически значимая связь между абсолютными остатками и переменной x1, что указывает на наличие гетероскедастичности.

2.3	Тест Уайта

•	Построила вспомогательную регрессию квадратов остатков от исходных регрессоров и их комбинаций

•	Рассчитала коэффициент детерминации вспомогательной модели

Результаты:

•	Коэффициент детерминации: Raux2=0.35

•	Статистика Уайта: W=n⋅Raux2=25×0.35=8.75

•	Вывод:

Wрасч=8.75<χкрит2(5;0.05)=11.07

Гипотеза о гетероскедастичности не отвергается (на уровне значимости 0.05).

2.4	Общий вывод по гетероскедастичности

Два из трех проведенных тестов указывают на наличие гетероскедастичности в остатках модели. 

## 3.	Проверка на автокорреляцию
3.1	Критерий Дарбина-Уотсона:

•	Вычислила последовательность разности остатков

•	Рассчитала статистику DW

Результаты:

•	DW=∑t=225(et−et−1)2∑t=125et2=1.50

•	Критические значения для n=25, k=2,  dL=1.12, dU=1.66

•	Вывод

dL<DW<dU (1.12<1.50<1.66)

Результат попадает в зону неопределенности. Требуются дополнительные тесты.

3.2	Q-статистика Льюинга-Бокса

Результаты:

•	Автокорреляции: r1=0.30, r2=0.20, r3=−0.10, r4=0.05

•	Q=25×27×∑j=14rj225−j=4.09Q=25×27×∑j=1425−jrj2=4.09

•	Вывод:

Qрасч=4.09<χкрит2(4;0.05)=9.49

Гипотеза об отсутствии автокорреляции не отвергается.

3.3	Общий вывод по автокорреляции

•	Результаты тестов не дают однозначного заключения:

•	Критерий Дарбина-Уотсона: зона неопределенности

•	Q-статистика Льюинга-Бокса: автокорреляция отсутствует
Скриншот работы
 ![Множественная регрессия нарушения допущений](blob:https://removal.ai/3f43f4c8-b8ec-4c16-a697-82cdb50d5891)
## 4.	Выводы:
Проведенная диагностика остатков регрессионной модели выявила:

•	Наличие гетероскедастичности — требует коррекции стандартных ошибок

•	Отсутствие явной автокорреляции — модель адекватна по этому критерию

•	Модель в целом удовлетворительно описывает зависимость индекса человеческого развития от факторов питания и продолжительности жизни, но требует коррекции статистических выводов с учетом выявленной гетероскедастичности.

# Нелинейная регрессия и способы реализации
Вариант 8
## 1.	Вывод о проделанной работе:
В ходе выполнения задания по эконометрике был проведён корреляционно-регрессионный анализ зависимости расходов на питание и непродовольственные товары y от среднемесячного дохода x для 11 семей.
## 2.	Основные этапы работы:
•	Оценены параметры трёх нелинейных моделей: степенной, показательной и равносторонней гиперболы.

•	Для каждой модели рассчитан индекс корреляции и коэффициент детерминации R2.

•	Проверена статистическая значимость моделей с помощью F-критерия Фишера при уровне значимости α=0.05.

•	Оценена точность моделей через среднюю ошибку аппроксимации.
Скриншот работы
 ![Нелинейная регрессия и способы реализации](blob:https://removal.ai/42c8a3b4-e8e4-448d-9c85-97938a57315c)
## 3.	Выводы:
•	Степенная модель y=0.268⋅x1.444 показала наилучшее качество аппроксимации: R2≈0.75, ошибка аппроксимации минимальна.

•	Показательная модель y=4.198⋅e0.0303x объясняет около 71% вариации расходов.

•	Гиперболическая модель y=2.923+26.93x имеет R2≈0.65 и наибольшую среднюю ошибку.

•	Все модели статистически значимы согласно F-критерию.

•	Экономический вывод: степенная модель наиболее адекватно отражает зависимость расходов от дохода. Коэффициент эластичности b≈1.444>1 означает, что при увеличении дохода на 1% расходы растут на 1.444%, что может свидетельствовать о повышении доли расходов на непродовольственные товары с ростом благосостояния семей.

# R
Вариант 8
## 1.	Загрузка и первичный анализ данных
В начале работы я загрузила встроенный датасет mtcars, содержащий характеристики 32 автомобилей. Для ознакомления со структурой данных использовала функции str(), summary() и head().

Выявлено:

•	Датасет состоит из 32 наблюдений и 11 переменных.

•	Большинство переменных являются числовыми (num), что упростило дальнейший анализ.

•	Переменные включают такие показатели, как расход топлива (mpg), мощность двигателя (hp), вес автомобиля (wt) и другие технические характеристики.
## 2.	Анализ расхода топлива (mpg)
Я рассчитала основные описательные статистики для переменной mpg (расход топлива в милях на галлон):

•	Среднее значение: 20.09 миль на галлон

•	Медиана: 19.20 миль на галлон

•	Стандартное отклонение: 6.03

•	Минимум: 10.40 миль на галлон

•	Максимум: 33.90 миль на галлон

Q1 = 15.43, Q3 = 22.80

Вывод:

Расход топлива у автомобилей в выборке варьируется значительно. Средний расход составляет около 20 миль на галлон, но разброс значений велик — от экономичных моделей (более 33 миль на галлон) до мощных автомобилей с высоким расходом (около 10 миль на галлон). Медиана ниже среднего, что указывает на правостороннюю асимметрию распределения.
## 3.	Создание новой переменной kpl
Для перевода расхода топлива в метрическую систему я создала новую переменную kpl (километры на литр), используя коэффициент преобразования 1 миля на галлон = 0.425 км на литр.

Результат:

Среднее значение новой переменной составило 8.55 км на литр. Это позволяет более наглядно оценить топливную экономичность автомобилей для пользователей, привыкших к метрической системе измерений.
## 4.	Анализ распределения мощности двигателя (hp)
Я построила гистограмму распределения переменной hp (мощность в лошадиных силах) с 10 интервалами и добавила вертикальную линию, обозначающую среднее значение (146.69 л.с.).

Наблюдения:

•	Большинство автомобилей (около 70%) имеют мощность в диапазоне 50–150 л.с..

•	Присутствуют несколько автомобилей с аномально высокой мощностью (свыше 200–300 л.с.), которые формируют «длинный хвост» распределения.

•	Средняя мощность не является типичной для большинства автомобилей в выборке из-за влияния выбросов.
## 5.	Анализ зависимости расхода топлива от веса автомобиля
Для изучения взаимосвязи между весом автомобиля и расходом топлива я построила диаграмму рассеяния с линией тренда.

Выявленная зависимость:

•	Обнаружена сильная отрицательная корреляция (коэффициент корреляции = -0.87).

•	Чем тяжелее автомобиль, тем больше расход топлива (меньше значение mpg).

•	Линия тренда четко демонстрирует линейную зависимость: с увеличением веса на 1 тыс. 
фунтов расход топлива снижается примерно на 5–6 миль на галлон.

Скриншот работы
![R](blob:https://removal.ai/c9604f8e-d8bb-4891-92ef-047c30bb8106)
## 6.	Выводы:
В результате проведенного анализа я сделала следующие выводы:

•	Датасет mtcars хорошо структурирован и удобен для анализа.

•	Топливная экономичность автомобилей сильно варьируется, что связано с их техническими характеристиками.

•	Мощность двигателя распределена неравномерно, с наличием «элитной» группы высокомощных автомобилей.

•	Вес автомобиля является одним из ключевых факторов, влияющих на расход топлива.

•	Полученные результаты могут быть полезны для сравнения автомобилей, прогнозирования расхода топлива и принятия решений при выборе транспортного средства.

